<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Registro ‚Äî QA Playground</title>
    <link rel="stylesheet" href="../../css/styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <header class="et-header">
      <div class="et-header-inner">
        <a href="../../index.html" class="et-logo" aria-label="In√≠cio">
          <img src="../../assets/icons/logo.svg" alt="Logo QA Playground" height="40" />
        </a>
        <nav class="et-nav" aria-label="Navega√ß√£o principal">
          <ul class="et-nav-list">
            <li><a href="../../index.html">In√≠cio</a></li>
            <li><a href="../fundamentos.html">Fundamentos</a></li>
            <li><a href="login.html">Login</a></li>
            <li><a href="registro.html" aria-current="page">Registro</a></li>
          </ul>
        </nav>
        <div class="et-header-actions">
          <button id="theme-toggle" aria-label="Alternar tema">üåû</button>
        </div>
      </div>
    </header>

    <main class="container">
      <section class="section">
        <div class="section-header">
          <h2>Crie sua Conta</h2>
          <div class="section-desc">Pratique automa√ß√£o e valida√ß√£o de registro de novos usu√°rios. Todos os elementos possuem <code>id</code> e <code>data-testid</code> para facilitar testes automatizados.</div>
        </div>

        <div class="subsections">
          <div class="subsection">
            <h3>Dados Pessoais</h3>
            <form id="registro-form" novalidate>
              <div class="form-grid">
                <div class="form-group form-full">
                  <label for="nome">Nome Completo</label>
                  <input 
                    type="text" 
                    id="nome" 
                    name="nome" 
                    data-testid="input-nome"
                    placeholder="Digite seu nome completo"
                    required
                    aria-describedby="nome-error nome-hint"
                  />
                  <div class="hint" id="nome-hint">M√≠nimo 3 caracteres</div>
                  <div class="error" id="nome-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="email">E-mail</label>
                  <input 
                    type="email" 
                    id="email" 
                    name="email" 
                    data-testid="input-email"
                    placeholder="seu@exemplo.com"
                    required
                    aria-describedby="email-error email-hint"
                  />
                  <div class="hint" id="email-hint">Digite um email v√°lido</div>
                  <div class="error" id="email-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="cpf">CPF</label>
                  <input 
                    type="text" 
                    id="cpf" 
                    name="cpf" 
                    data-testid="input-cpf"
                    maxlength="14" 
                    placeholder="000.000.000-00"
                    required
                    aria-describedby="cpf-error cpf-hint"
                  />
                  <div class="hint" id="cpf-hint">Formato: 000.000.000-00</div>
                  <div class="error" id="cpf-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="nascimento">Data de Nascimento</label>
                  <input 
                    type="date" 
                    id="nascimento" 
                    name="nascimento" 
                    data-testid="input-nascimento"
                    required
                    aria-describedby="nascimento-error nascimento-hint"
                  />
                  <div class="hint" id="nascimento-hint">Voc√™ deve ter pelo menos 18 anos</div>
                  <div class="error" id="nascimento-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="telefone">Telefone</label>
                  <input 
                    type="tel" 
                    id="telefone" 
                    name="telefone" 
                    data-testid="input-telefone"
                    maxlength="15" 
                    placeholder="(00) 00000-0000"
                    required
                    aria-describedby="telefone-error telefone-hint"
                  />
                  <div class="hint" id="telefone-hint">Formato: (00) 00000-0000</div>
                  <div class="error" id="telefone-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="genero">G√™nero</label>
                  <select 
                    id="genero" 
                    name="genero" 
                    data-testid="select-genero"
                    required
                    aria-describedby="genero-error"
                  >
                    <option value="">Selecione</option>
                    <option value="masculino">Masculino</option>
                    <option value="feminino">Feminino</option>
                    <option value="outro">Outro</option>
                    <option value="nao-informar">Prefiro n√£o informar</option>
                  </select>
                  <div class="error" id="genero-error" aria-live="polite" style="display:none"></div>
                </div>
              </div>

              <h3 style="margin-top: var(--spacing-lg); margin-bottom: var(--spacing-md);">Endere√ßo</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="cep">CEP</label>
                  <input 
                    type="text" 
                    id="cep" 
                    name="cep" 
                    data-testid="input-cep"
                    maxlength="9" 
                    placeholder="00000-000"
                    required
                    aria-describedby="cep-error cep-hint"
                  />
                  <div class="hint" id="cep-hint">Formato: 00000-000</div>
                  <div class="error" id="cep-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group form-full">
                  <label for="endereco">Endere√ßo</label>
                  <input 
                    type="text" 
                    id="endereco" 
                    name="endereco" 
                    data-testid="input-endereco"
                    placeholder="Rua, Avenida, etc."
                    required
                    aria-describedby="endereco-error"
                  />
                  <div class="error" id="endereco-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="numero">N√∫mero</label>
                  <input 
                    type="text" 
                    id="numero" 
                    name="numero" 
                    data-testid="input-numero"
                    placeholder="123"
                    required
                    aria-describedby="numero-error"
                  />
                  <div class="error" id="numero-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="complemento">Complemento</label>
                  <input 
                    type="text" 
                    id="complemento" 
                    name="complemento" 
                    data-testid="input-complemento"
                    placeholder="Apto, Bloco, etc. (opcional)"
                    aria-describedby="complemento-hint"
                  />
                  <div class="hint" id="complemento-hint">Opcional</div>
                </div>

                <div class="form-group">
                  <label for="bairro">Bairro</label>
                  <input 
                    type="text" 
                    id="bairro" 
                    name="bairro" 
                    data-testid="input-bairro"
                    placeholder="Nome do bairro"
                    required
                    aria-describedby="bairro-error"
                  />
                  <div class="error" id="bairro-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="cidade">Cidade</label>
                  <input 
                    type="text" 
                    id="cidade" 
                    name="cidade" 
                    data-testid="input-cidade"
                    placeholder="Nome da cidade"
                    required
                    aria-describedby="cidade-error"
                  />
                  <div class="error" id="cidade-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group">
                  <label for="estado">Estado</label>
                  <select 
                    id="estado" 
                    name="estado" 
                    data-testid="select-estado"
                    required
                    aria-describedby="estado-error"
                  >
                    <option value="">Selecione</option>
                    <option value="AC">Acre</option>
                    <option value="AL">Alagoas</option>
                    <option value="AP">Amap√°</option>
                    <option value="AM">Amazonas</option>
                    <option value="BA">Bahia</option>
                    <option value="CE">Cear√°</option>
                    <option value="DF">Distrito Federal</option>
                    <option value="ES">Esp√≠rito Santo</option>
                    <option value="GO">Goi√°s</option>
                    <option value="MA">Maranh√£o</option>
                    <option value="MT">Mato Grosso</option>
                    <option value="MS">Mato Grosso do Sul</option>
                    <option value="MG">Minas Gerais</option>
                    <option value="PA">Par√°</option>
                    <option value="PB">Para√≠ba</option>
                    <option value="PR">Paran√°</option>
                    <option value="PE">Pernambuco</option>
                    <option value="PI">Piau√≠</option>
                    <option value="RJ">Rio de Janeiro</option>
                    <option value="RN">Rio Grande do Norte</option>
                    <option value="RS">Rio Grande do Sul</option>
                    <option value="RO">Rond√¥nia</option>
                    <option value="RR">Roraima</option>
                    <option value="SC">Santa Catarina</option>
                    <option value="SP">S√£o Paulo</option>
                    <option value="SE">Sergipe</option>
                    <option value="TO">Tocantins</option>
                  </select>
                  <div class="error" id="estado-error" aria-live="polite" style="display:none"></div>
                </div>
              </div>

              <h3 style="margin-top: var(--spacing-lg); margin-bottom: var(--spacing-md);">Seguran√ßa</h3>
              <div class="form-grid">
                <div class="form-group">
                  <label for="senha">Senha</label>
                  <input 
                    type="password" 
                    id="senha" 
                    name="senha" 
                    data-testid="input-senha"
                    placeholder="M√≠nimo 8 caracteres"
                    required
                    aria-describedby="senha-error senha-hint"
                  />
                  <div class="hint" id="senha-hint">M√≠nimo 8 caracteres, incluindo letras e n√∫meros</div>
                  <div class="error" id="senha-error" aria-live="polite" style="display:none"></div>
                  <div id="senha-strength" style="margin-top: var(--spacing-xs); font-size: var(--font-size-sm);"></div>
                </div>

                <div class="form-group">
                  <label for="confirmar-senha">Confirmar Senha</label>
                  <input 
                    type="password" 
                    id="confirmar-senha" 
                    name="confirmar-senha" 
                    data-testid="input-confirmar-senha"
                    placeholder="Digite a senha novamente"
                    required
                    aria-describedby="confirmar-senha-error confirmar-senha-hint"
                  />
                  <div class="hint" id="confirmar-senha-hint">As senhas devem ser iguais</div>
                  <div class="error" id="confirmar-senha-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group form-full">
                  <label class="radio-group" style="align-items: center; gap: 8px;">
                    <input 
                      type="checkbox" 
                      id="aceite-termos" 
                      name="aceite-termos" 
                      data-testid="checkbox-termos"
                      required
                    />
                    <span>Eu aceito os <a href="#" style="color: var(--accent);">termos e condi√ß√µes</a></span>
                  </label>
                  <div class="error" id="aceite-termos-error" aria-live="polite" style="display:none"></div>
                </div>

                <div class="form-group form-full">
                  <button type="submit" id="btn-registrar" data-testid="btn-registrar" class="btn">Criar Conta</button>
                </div>
              </div>
            </form>
          </div>

          <div class="subsection">
            <h3>Informa√ß√µes para Testes</h3>
            <div style="background: var(--surface); padding: var(--spacing-md); border-radius: var(--border-radius-md); border-left: 4px solid var(--accent);">
              <p style="margin-bottom: var(--spacing-sm);"><strong>Dados de Teste:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Nome: Qualquer nome com mais de 3 caracteres</li>
                <li>Email: Formato v√°lido (ex: teste@exemplo.com)</li>
                <li>CPF: Formato 000.000.000-00</li>
                <li>Data: Deve ter pelo menos 18 anos</li>
                <li>Senha: M√≠nimo 8 caracteres com letras e n√∫meros</li>
              </ul>
              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Elementos identific√°veis:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li><code>data-testid="input-nome"</code></li>
                <li><code>data-testid="input-email"</code></li>
                <li><code>data-testid="input-cpf"</code></li>
                <li><code>data-testid="input-senha"</code></li>
                <li><code>data-testid="input-confirmar-senha"</code></li>
                <li><code>data-testid="checkbox-termos"</code></li>
                <li><code>data-testid="btn-registrar"</code></li>
              </ul>
            </div>
          </div>
        </div>

        <div style="margin-top: var(--spacing-xl); text-align: center;">
          <p class="muted">
            J√° tem uma conta? <a href="login.html" data-testid="link-login" style="color: var(--accent);">Fazer login</a>
          </p>
          <a href="../../index.html" class="btn btn-secondary" style="margin-top: var(--spacing-md);">‚Üê Voltar para In√≠cio</a>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      QA Playground ‚Äî Projeto educacional ‚Ä¢ Portugu√™s
    </footer>

    <script src="../../js/app.js"></script>
    <script>
      // Fun√ß√µes de m√°scara
      function maskCPF(value) {
        return value
          .replace(/\D/g, '')
          .replace(/(\d{3})(\d)/, '$1.$2')
          .replace(/(\d{3})(\d)/, '$1.$2')
          .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
      }

      function maskTelefone(value) {
        return value
          .replace(/\D/g, '')
          .replace(/(\d{2})(\d)/, '($1) $2')
          .replace(/(\d{5})(\d{4})$/, '$1-$2');
      }

      function maskCEP(value) {
        return value
          .replace(/\D/g, '')
          .replace(/(\d{5})(\d)/, '$1-$2');
      }

      // Aplicar m√°scaras
      document.getElementById('cpf').addEventListener('input', function(e) {
        e.target.value = maskCPF(e.target.value);
      });

      document.getElementById('telefone').addEventListener('input', function(e) {
        e.target.value = maskTelefone(e.target.value);
      });

      document.getElementById('cep').addEventListener('input', function(e) {
        e.target.value = maskCEP(e.target.value);
      });

      // Valida√ß√£o de CPF
      function validateCPF(cpf) {
        cpf = cpf.replace(/\D/g, '');
        if (cpf.length !== 11) return false;
        if (/^(\d)\1+$/.test(cpf)) return false;
        return true;
      }

      // Valida√ß√£o de email
      function validateEmail(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
      }

      // Valida√ß√£o de idade (18 anos)
      function validateAge(dateString) {
        const today = new Date();
        const birthDate = new Date(dateString);
        let age = today.getFullYear() - birthDate.getFullYear();
        const monthDiff = today.getMonth() - birthDate.getMonth();
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
          age--;
        }
        return age >= 18;
      }

      // Valida√ß√£o de senha
      function validatePassword(password) {
        if (password.length < 8) return { valid: false, message: 'Senha deve ter no m√≠nimo 8 caracteres.' };
        if (!/[a-zA-Z]/.test(password)) return { valid: false, message: 'Senha deve conter pelo menos uma letra.' };
        if (!/\d/.test(password)) return { valid: false, message: 'Senha deve conter pelo menos um n√∫mero.' };
        return { valid: true };
      }

      // For√ßa da senha
      function getPasswordStrength(password) {
        if (!password) return { strength: 0, text: '', color: '' };
        
        let strength = 0;
        if (password.length >= 8) strength++;
        if (password.length >= 12) strength++;
        if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;
        if (/\d/.test(password)) strength++;
        if (/[^a-zA-Z0-9]/.test(password)) strength++;

        const levels = [
          { text: 'Muito fraca', color: '#e74c3c' },
          { text: 'Fraca', color: '#e67e22' },
          { text: 'M√©dia', color: '#f39c12' },
          { text: 'Forte', color: '#27ae60' },
          { text: 'Muito forte', color: '#2ecc71' }
        ];

        return levels[Math.min(strength, 4)];
      }

      // Atualizar for√ßa da senha em tempo real
      document.getElementById('senha').addEventListener('input', function() {
        const password = this.value;
        const strengthDiv = document.getElementById('senha-strength');
        const strength = getPasswordStrength(password);
        
        if (password) {
          strengthDiv.innerHTML = `<span style="color: ${strength.color}; font-weight: 600;">For√ßa: ${strength.text}</span>`;
        } else {
          strengthDiv.innerHTML = '';
        }
      });

      // Valida√ß√£o do formul√°rio
      const registroForm = document.getElementById('registro-form');
      
      registroForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Limpar erros anteriores
        ['nome', 'email', 'cpf', 'nascimento', 'telefone', 'genero', 'cep', 'endereco', 'numero', 'bairro', 'cidade', 'estado', 'senha', 'confirmar-senha', 'aceite-termos'].forEach(field => {
          window.clearFieldError(field);
        });
        
        let isValid = true;
        
        // Valida√ß√£o de nome
        const nome = document.getElementById('nome').value.trim();
        if (!nome) {
          window.setFieldError('nome', 'Nome √© obrigat√≥rio.');
          isValid = false;
        } else if (nome.length < 3) {
          window.setFieldError('nome', 'Nome deve ter no m√≠nimo 3 caracteres.');
          isValid = false;
        }
        
        // Valida√ß√£o de email
        const email = document.getElementById('email').value.trim();
        if (!email) {
          window.setFieldError('email', 'Email √© obrigat√≥rio.');
          isValid = false;
        } else if (!validateEmail(email)) {
          window.setFieldError('email', 'Formato de email inv√°lido.');
          isValid = false;
        }
        
        // Valida√ß√£o de CPF
        const cpf = document.getElementById('cpf').value;
        if (!cpf) {
          window.setFieldError('cpf', 'CPF √© obrigat√≥rio.');
          isValid = false;
        } else if (!validateCPF(cpf)) {
          window.setFieldError('cpf', 'CPF inv√°lido.');
          isValid = false;
        }
        
        // Valida√ß√£o de data de nascimento
        const nascimento = document.getElementById('nascimento').value;
        if (!nascimento) {
          window.setFieldError('nascimento', 'Data de nascimento √© obrigat√≥ria.');
          isValid = false;
        } else if (!validateAge(nascimento)) {
          window.setFieldError('nascimento', 'Voc√™ deve ter pelo menos 18 anos.');
          isValid = false;
        }
        
        // Valida√ß√£o de telefone
        const telefone = document.getElementById('telefone').value;
        if (!telefone) {
          window.setFieldError('telefone', 'Telefone √© obrigat√≥rio.');
          isValid = false;
        } else if (telefone.replace(/\D/g, '').length < 10) {
          window.setFieldError('telefone', 'Telefone inv√°lido.');
          isValid = false;
        }
        
        // Valida√ß√£o de g√™nero
        const genero = document.getElementById('genero').value;
        if (!genero) {
          window.setFieldError('genero', 'Selecione um g√™nero.');
          isValid = false;
        }
        
        // Valida√ß√£o de CEP
        const cep = document.getElementById('cep').value;
        if (!cep) {
          window.setFieldError('cep', 'CEP √© obrigat√≥rio.');
          isValid = false;
        } else if (cep.replace(/\D/g, '').length !== 8) {
          window.setFieldError('cep', 'CEP inv√°lido.');
          isValid = false;
        }
        
        // Valida√ß√£o de endere√ßo
        const endereco = document.getElementById('endereco').value.trim();
        if (!endereco) {
          window.setFieldError('endereco', 'Endere√ßo √© obrigat√≥rio.');
          isValid = false;
        }
        
        // Valida√ß√£o de n√∫mero
        const numero = document.getElementById('numero').value.trim();
        if (!numero) {
          window.setFieldError('numero', 'N√∫mero √© obrigat√≥rio.');
          isValid = false;
        }
        
        // Valida√ß√£o de bairro
        const bairro = document.getElementById('bairro').value.trim();
        if (!bairro) {
          window.setFieldError('bairro', 'Bairro √© obrigat√≥rio.');
          isValid = false;
        }
        
        // Valida√ß√£o de cidade
        const cidade = document.getElementById('cidade').value.trim();
        if (!cidade) {
          window.setFieldError('cidade', 'Cidade √© obrigat√≥ria.');
          isValid = false;
        }
        
        // Valida√ß√£o de estado
        const estado = document.getElementById('estado').value;
        if (!estado) {
          window.setFieldError('estado', 'Selecione um estado.');
          isValid = false;
        }
        
        // Valida√ß√£o de senha
        const senha = document.getElementById('senha').value;
        if (!senha) {
          window.setFieldError('senha', 'Senha √© obrigat√≥ria.');
          isValid = false;
        } else {
          const passwordValidation = validatePassword(senha);
          if (!passwordValidation.valid) {
            window.setFieldError('senha', passwordValidation.message);
            isValid = false;
          }
        }
        
        // Valida√ß√£o de confirma√ß√£o de senha
        const confirmarSenha = document.getElementById('confirmar-senha').value;
        if (!confirmarSenha) {
          window.setFieldError('confirmar-senha', 'Confirma√ß√£o de senha √© obrigat√≥ria.');
          isValid = false;
        } else if (senha !== confirmarSenha) {
          window.setFieldError('confirmar-senha', 'As senhas n√£o coincidem.');
          isValid = false;
        }
        
        // Valida√ß√£o de termos
        const aceiteTermos = document.getElementById('aceite-termos').checked;
        if (!aceiteTermos) {
          const errorDiv = document.getElementById('aceite-termos-error');
          errorDiv.textContent = 'Voc√™ deve aceitar os termos e condi√ß√µes.';
          errorDiv.style.display = 'block';
          isValid = false;
        }
        
        if (!isValid) return;
        
        // Simula√ß√£o de registro
        document.getElementById('btn-registrar').disabled = true;
        document.getElementById('btn-registrar').textContent = 'Criando conta...';
        
        setTimeout(() => {
          window.showToast('Conta criada com sucesso!');
          registroForm.reset();
          document.getElementById('senha-strength').innerHTML = '';
          document.getElementById('btn-registrar').disabled = false;
          document.getElementById('btn-registrar').textContent = 'Criar Conta';
        }, 1500);
      });

      // Valida√ß√£o em tempo real
      document.getElementById('email').addEventListener('blur', function() {
        const email = this.value.trim();
        if (email && !validateEmail(email)) {
          window.setFieldError('email', 'Formato de email inv√°lido.');
        } else {
          window.clearFieldError('email');
        }
      });

      document.getElementById('cpf').addEventListener('blur', function() {
        const cpf = this.value;
        if (cpf && !validateCPF(cpf)) {
          window.setFieldError('cpf', 'CPF inv√°lido.');
        } else {
          window.clearFieldError('cpf');
        }
      });

      document.getElementById('nascimento').addEventListener('blur', function() {
        const date = this.value;
        if (date && !validateAge(date)) {
          window.setFieldError('nascimento', 'Voc√™ deve ter pelo menos 18 anos.');
        } else {
          window.clearFieldError('nascimento');
        }
      });

      document.getElementById('confirmar-senha').addEventListener('blur', function() {
        const senha = document.getElementById('senha').value;
        const confirmarSenha = this.value;
        if (confirmarSenha && senha !== confirmarSenha) {
          window.setFieldError('confirmar-senha', 'As senhas n√£o coincidem.');
        } else {
          window.clearFieldError('confirmar-senha');
        }
      });
    </script>
  </body>
</html>
