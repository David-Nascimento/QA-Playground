<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Upload Múltiplo — QA Playground</title>
    <link rel="stylesheet" href="../../../css/styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <header class="et-header">
      <div class="et-header-inner">
        <a href="../../index.html" class="et-logo" aria-label="Início">
          <img src="../../../assets/icons/logo.svg" alt="Logo QA Playground" height="40" />
        </a>
        <nav class="et-nav" aria-label="Navegação principal">
          <ul class="et-nav-list">
            <li><a href="../../index.html">Início</a></li>
            <li><a href="../../fundamentos.html">Fundamentos</a></li>
            <li><a href="../../junior/formularios/">Formulários</a></li>
            <li><a href="../tabelas/">Tabelas (Pleno)</a></li>
            <li><a href="index.html">Interações (Pleno)</a></li>
            <li><a href="../arquivos/">Arquivos (Pleno)</a></li>
          </ul>
        </nav>
        <div class="et-header-actions">
          <button id="theme-toggle" aria-label="Alternar tema">🌞</button>
        </div>
      </div>
    </header>

    <main class="container">
      <section class="section">
        <div class="section-header">
          <h2>Upload Múltiplo</h2>
          <div class="section-desc">Pratique testes de upload de múltiplos arquivos simultaneamente. Esta página é ideal para testar automação de seleção múltipla, validação de lista de arquivos e upload em lote.</div>
        </div>

        <div class="subsections subsections-vertical">
          <div class="subsection">
            <h3>Sobre esta Seção</h3>
            <div style="background: var(--surface); padding: var(--spacing-md); border-radius: var(--border-radius-md); border-left: 4px solid var(--accent);">
              <p style="margin-bottom: var(--spacing-sm);"><strong>Atividades do Dia a Dia:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Testar seleção de múltiplos arquivos</li>
                <li>Validar lista de arquivos selecionados</li>
                <li>Praticar automação de upload múltiplo</li>
                <li>Testar remoção de arquivos da lista</li>
                <li>Validar contagem de arquivos selecionados</li>
                <li>Testar limites de quantidade de arquivos</li>
                <li>Validar informações de cada arquivo na lista</li>
              </ul>
              
              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Como Utilizar:</strong></p>
              <ol style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Clique em "Selecionar arquivos" e escolha múltiplos arquivos (Ctrl+Click ou Shift+Click)</li>
                <li>Observe a lista de arquivos selecionados</li>
                <li>Veja as informações de cada arquivo (nome, tamanho, tipo)</li>
                <li>Clique em "Remover" para remover um arquivo da lista</li>
                <li>Valide a contagem total de arquivos</li>
                <li>Use os <code>data-testid</code> para criar testes automatizados</li>
              </ol>
            </div>
          </div>

          <div class="subsection">
            <h3>Seleção Múltipla de Arquivos</h3>
            <p class="muted" style="margin-bottom: var(--spacing-md);">Selecione múltiplos arquivos para upload.</p>
            
            <div class="form-group">
              <label for="file-input-multiple">Selecionar arquivos (múltiplos)</label>
              <input 
                id="file-input-multiple" 
                type="file" 
                multiple
                data-testid="file-input-multiple"
                accept="image/*,application/pdf,.doc,.docx,.txt"
              />
              <div class="hint">Você pode selecionar múltiplos arquivos de uma vez (Ctrl+Click ou Shift+Click)</div>
            </div>

            <div id="files-list" data-testid="files-list" style="margin-top: var(--spacing-md);">
              <p class="muted">Nenhum arquivo selecionado ainda...</p>
            </div>

            <div id="files-summary" data-testid="files-summary" style="margin-top: var(--spacing-md); padding: var(--spacing-md); background: var(--surface); border-radius: var(--border-radius-md); display: none;">
              <strong>Resumo:</strong>
              <div id="summary-content" style="margin-top: var(--spacing-sm); font-size: var(--font-size-sm); color: var(--muted);"></div>
            </div>
          </div>

          <div class="subsection" style="margin-top: var(--spacing-lg);">
            <h3>Informações para Testes</h3>
            <div style="background: var(--surface); padding: var(--spacing-md); border-radius: var(--border-radius-md); border-left: 4px solid var(--accent);">
              <p style="margin-bottom: var(--spacing-sm);"><strong>Cenários de Teste:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Selecionar múltiplos arquivos simultaneamente</li>
                <li>Validar lista de arquivos selecionados</li>
                <li>Testar remoção de arquivos individuais</li>
                <li>Validar contagem total de arquivos</li>
                <li>Testar seleção de diferentes formatos</li>
                <li>Validar informações de cada arquivo</li>
              </ul>
              
              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Elementos identificáveis:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li><code>data-testid="file-input-multiple"</code> - Campo de seleção múltipla</li>
                <li><code>data-testid="files-list"</code> - Lista de arquivos</li>
                <li><code>data-testid="files-summary"</code> - Resumo de arquivos</li>
                <li><code>data-testid="file-item-[index]"</code> - Cada item da lista</li>
                <li><code>data-testid="btn-remove-[index]"</code> - Botão remover por item</li>
              </ul>

              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Exemplos de Teste Automatizado:</strong></p>
              
              <div class="test-tabs">
                <button class="test-tab active" data-target="tab-cypress">Cypress</button>
                <button class="test-tab" data-target="tab-playwright">Playwright</button>
                <button class="test-tab" data-target="tab-selenium-java">Selenium (Java)</button>
                <button class="test-tab" data-target="tab-capybara">Capybara (Ruby)</button>
                <button class="test-tab" data-target="tab-robot">Robot Framework</button>
              </div>
              
              <div class="test-tab-content">
              
                <pre id="tab-cypress" class="test-code active"><code>
// Cypress - Testar upload múltiplo
cy.get('[data-testid="file-input-multiple"]').selectFile([
  'cypress/fixtures/file1.jpg',
  'cypress/fixtures/file2.pdf',
  'cypress/fixtures/file3.txt'
])
cy.get('[data-testid="files-list"]').should('contain', 'file1.jpg')
cy.get('[data-testid="files-list"]').should('contain', 'file2.pdf')
cy.get('[data-testid="files-summary"]').should('be.visible')
cy.get('[data-testid="files-summary"]').should('contain', '3 arquivos')

// Remover arquivo
cy.get('[data-testid="btn-remove-0"]').click()
cy.get('[data-testid="files-summary"]').should('contain', '2 arquivos')
                </code></pre>
              
                <pre id="tab-playwright" class="test-code"><code>
// Playwright - Testar upload múltiplo
await page.getByTestId('file-input-multiple').setInputFiles([
  'tests/fixtures/file1.jpg',
  'tests/fixtures/file2.pdf',
  'tests/fixtures/file3.txt'
])
await expect(page.getByTestId('files-list')).toContainText('file1.jpg')
await expect(page.getByTestId('files-list')).toContainText('file2.pdf')
await expect(page.getByTestId('files-summary')).toBeVisible()
await expect(page.getByTestId('files-summary')).toContainText('3 arquivos')

// Remover arquivo
await page.getByTestId('btn-remove-0').click()
await expect(page.getByTestId('files-summary')).toContainText('2 arquivos')
                </code></pre>
              
                <pre id="tab-selenium-java" class="test-code"><code>
// Selenium Java - Testar upload múltiplo
WebElement fileInput = driver.findElement(By.cssSelector("[data-testid='file-input-multiple']"));
String file1 = System.getProperty("user.dir") + "/src/test/resources/file1.jpg";
String file2 = System.getProperty("user.dir") + "/src/test/resources/file2.pdf";
fileInput.sendKeys(file1 + "\n" + file2);
Thread.sleep(1000);
WebElement filesList = driver.findElement(By.cssSelector("[data-testid='files-list']"));
assert filesList.getText().contains("file1.jpg");
assert filesList.getText().contains("file2.pdf");
WebElement summary = driver.findElement(By.cssSelector("[data-testid='files-summary']"));
assert summary.isDisplayed();
                </code></pre>
              
                <pre id="tab-capybara" class="test-code"><code>
# Capybara (Ruby) - Testar upload múltiplo
attach_file('file-input-multiple', [
  Rails.root.join('spec/fixtures/file1.jpg'),
  Rails.root.join('spec/fixtures/file2.pdf')
])
expect(find('[data-testid="files-list"]')).to have_content('file1.jpg')
expect(find('[data-testid="files-list"]')).to have_content('file2.pdf')
expect(find('[data-testid="files-summary"]')).to be_visible
expect(find('[data-testid="files-summary"]')).to have_content('2 arquivos')

# Remover arquivo
find('[data-testid="btn-remove-0"]').click
expect(find('[data-testid="files-summary"]')).to have_content('1 arquivo')
                </code></pre>
                  
                <pre id="tab-robot" class="test-code"><code>
*** Test Cases ***
Testar upload múltiplo
    Choose File    css:[data-testid="file-input-multiple"]    ${CURDIR}/file1.jpg,${CURDIR}/file2.pdf
    Element Should Contain    css:[data-testid="files-list"]    file1.jpg
    Element Should Contain    css:[data-testid="files-list"]    file2.pdf
    Element Should Be Visible    css:[data-testid="files-summary"]
    Element Should Contain    css:[data-testid="files-summary"]    2 arquivos

Remover arquivo da lista
    Click Element    css:[data-testid="btn-remove-0"]
    Element Should Contain    css:[data-testid="files-summary"]    1 arquivo
                </code></pre>
              
              </div>
            </div>
          </div>
        </div>

        <div style="margin-top: var(--spacing-xl); text-align: center;">
          <a href="../../index.html" class="btn btn-secondary">← Voltar para Início</a>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      QA Playground — Projeto educacional • Português
    </footer>

    <script src="../../../js/app.js"></script>
    <script>
      const fileInput = document.getElementById('file-input-multiple');
      const filesList = document.getElementById('files-list');
      const filesSummary = document.getElementById('files-summary');
      const summaryContent = document.getElementById('summary-content');
      let selectedFiles = [];

      function formatFileSize(bytes) {
        if (bytes < 1024) return bytes + ' B';
        if (bytes < 1024 * 1024) return Math.round(bytes / 1024) + ' KB';
        return (bytes / (1024 * 1024)).toFixed(2) + ' MB';
      }

      function renderFilesList() {
        if (selectedFiles.length === 0) {
          filesList.innerHTML = '<p class="muted">Nenhum arquivo selecionado ainda...</p>';
          filesSummary.style.display = 'none';
          return;
        }

        let html = '<div style="display: flex; flex-direction: column; gap: var(--spacing-sm);">';
        selectedFiles.forEach((file, index) => {
          html += `
            <div data-testid="file-item-${index}" style="padding: var(--spacing-md); background: var(--surface); border-radius: var(--border-radius-md); border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;">
              <div style="flex: 1;">
                <strong>${file.name}</strong>
                <div style="font-size: var(--font-size-sm); color: var(--muted); margin-top: var(--spacing-xs);">
                  ${formatFileSize(file.size)} • ${file.type || 'Tipo desconhecido'}
                </div>
              </div>
              <button 
                class="btn btn-secondary" 
                data-testid="btn-remove-${index}"
                onclick="removeFile(${index})"
                style="margin-left: var(--spacing-md);"
              >
                Remover
              </button>
            </div>
          `;
        });
        html += '</div>';
        filesList.innerHTML = html;

        // Atualizar resumo
        const totalSize = selectedFiles.reduce((sum, file) => sum + file.size, 0);
        summaryContent.innerHTML = `
          <div>Total: <strong>${selectedFiles.length} ${selectedFiles.length === 1 ? 'arquivo' : 'arquivos'}</strong></div>
          <div>Tamanho total: <strong>${formatFileSize(totalSize)}</strong></div>
        `;
        filesSummary.style.display = 'block';
      }

      function removeFile(index) {
        selectedFiles.splice(index, 1);
        fileInput.value = '';
        renderFilesList();
        window.showToast('Arquivo removido da lista');
      }

      fileInput.addEventListener('change', function() {
        const files = Array.from(this.files);
        selectedFiles = selectedFiles.concat(files);
        renderFilesList();
        window.showToast(`${files.length} arquivo(s) adicionado(s)`);
      });

      // Inicializar abas de teste automatizado
      (function() {
        function initTabs() {
          const tabsContainer = document.querySelector('.test-tabs');
          
          if (!tabsContainer) {
            setTimeout(initTabs, 100);
            return;
          }

          tabsContainer.addEventListener('click', function(e) {
            const clickedTab = e.target.closest('.test-tab');
            
            if (!clickedTab) return;
            
            e.preventDefault();
            e.stopPropagation();
            
            const targetId = clickedTab.dataset.target;
            if (!targetId) return;
            
            document.querySelectorAll('.test-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.test-code').forEach(c => c.classList.remove('active'));

            clickedTab.classList.add('active');
            const targetContent = document.getElementById(targetId);
            if (targetContent) {
              targetContent.classList.add('active');
            }
          });
        }

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', initTabs);
        } else {
          initTabs();
        }
      })();
    </script>
  </body>
</html>
