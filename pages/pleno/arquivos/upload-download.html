<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Upload e Download — QA Playground</title>
    <link rel="stylesheet" href="../../../css/styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <header class="et-header">
      <div class="et-header-inner">
        <a href="../../index.html" class="et-logo" aria-label="Início">
          <img src="../../../assets/icons/logo.svg" alt="Logo QA Playground" height="40" />
        </a>
        <nav class="et-nav" aria-label="Navegação principal">
          <ul class="et-nav-list">
            <li><a href="../../index.html">Início</a></li>
            <li><a href="fundamentos.html">Fundamentos</a></li>
            <li><a href="formularios.html">Formulários</a></li>
            <li><a href="tabelas-pleno-index.html">Tabelas (Pleno)</a></li>
            <li><a href="interacoes-pleno-index.html">Interações (Pleno)</a></li>
            <li><a href="arquivos-pleno-index.html">Arquivos (Pleno)</a></li>
          </ul>
        </nav>
        <div class="et-header-actions">
          <button id="theme-toggle" aria-label="Alternar tema">🌞</button>
        </div>
      </div>
    </header>

    <main class="container">
      <section class="section">
        <div class="section-header">
          <h2>Upload e Download de Arquivos</h2>
          <div class="section-desc">Pratique testes de upload e download de arquivos. Valide seleção, envio, tamanho e formatos de arquivos. Esta página é ideal para testar automação de upload/download, validação de formatos e manipulação de arquivos.</div>
        </div>

        <div class="subsections subsections-vertical">
          <div class="subsection">
            <h3>Sobre esta Seção</h3>
            <div style="background: var(--surface); padding: var(--spacing-md); border-radius: var(--border-radius-md); border-left: 4px solid var(--accent);">
              <p style="margin-bottom: var(--spacing-sm);"><strong>Atividades do Dia a Dia:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Testar seleção de arquivos para upload</li>
                <li>Validar informações do arquivo (nome, tamanho, tipo)</li>
                <li>Praticar automação de upload de arquivos</li>
                <li>Testar download de arquivos em diferentes formatos</li>
                <li>Validar preview de imagens após seleção</li>
                <li>Testar limites de tamanho e formatos aceitos</li>
                <li>Validar que arquivos foram baixados corretamente</li>
              </ul>
              
              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Como Utilizar:</strong></p>
              <ol style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Clique em "Selecionar arquivo" para escolher um arquivo</li>
                <li>Observe as informações exibidas (nome, tamanho, tipo)</li>
                <li>Para imagens, veja o preview exibido</li>
                <li>Clique nos botões de download para testar downloads</li>
                <li>Valide que os arquivos foram baixados corretamente</li>
                <li>Use os <code>data-testid</code> para criar testes automatizados</li>
              </ol>
            </div>
          </div>

          <div class="subsection">
            <h3>Upload de Arquivo</h3>
            <p class="muted" style="margin-bottom: var(--spacing-md);">Selecione um arquivo para upload (aceita imagens, PDF, DOC, DOCX).</p>
            <div class="form-group">
              <label for="file-input">Selecionar arquivo</label>
              <input 
                id="file-input" 
                type="file" 
                data-testid="file-input"
                accept="image/*,application/pdf,.doc,.docx"
              />
              <div class="hint">Formatos aceitos: Imagens, PDF, DOC, DOCX</div>
              <div id="file-info" data-testid="file-info" class="hint" aria-live="polite" style="margin-top: var(--spacing-sm);"></div>
            </div>
            
            <div id="file-preview" data-testid="file-preview" style="margin-top: var(--spacing-md); display: none;">
              <strong>Preview:</strong>
              <div id="preview-content" data-testid="preview-content" style="margin-top: var(--spacing-sm);"></div>
            </div>
          </div>

          <div class="subsection">
            <h3>Download de Arquivo</h3>
            <p class="muted" style="margin-bottom: var(--spacing-md);">Teste o download de arquivos simulados.</p>
            <div class="controls">
              <button id="btn-download" class="btn" data-testid="btn-download">Baixar Arquivo Exemplo (TXT)</button>
              <button id="btn-download-json" class="btn btn-secondary" data-testid="btn-download-json">Baixar JSON</button>
              <button id="btn-download-csv" class="btn btn-secondary" data-testid="btn-download-csv">Baixar CSV</button>
            </div>
            <div id="download-status" data-testid="download-status" class="hint" style="margin-top: var(--spacing-sm);"></div>
          </div>

          <div class="subsection" style="margin-top: var(--spacing-lg);">
            <h3>Informações para Testes</h3>
            <div style="background: var(--surface); padding: var(--spacing-md); border-radius: var(--border-radius-md); border-left: 4px solid var(--accent);">
              <p style="margin-bottom: var(--spacing-sm);"><strong>Cenários de Teste:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Selecionar arquivo e validar informações</li>
                <li>Testar upload de diferentes formatos (imagens, PDF, DOC)</li>
                <li>Validar preview de imagens</li>
                <li>Testar download de arquivos TXT, JSON e CSV</li>
                <li>Validar que arquivos foram baixados corretamente</li>
                <li>Testar limites de tamanho de arquivo</li>
                <li>Validar formatos aceitos e rejeitados</li>
              </ul>
              
              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Elementos identificáveis:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li><code>data-testid="file-input"</code> - Campo de seleção de arquivo</li>
                <li><code>data-testid="file-info"</code> - Informações do arquivo selecionado</li>
                <li><code>data-testid="file-preview"</code> - Área de preview</li>
                <li><code>data-testid="preview-content"</code> - Conteúdo do preview</li>
                <li><code>data-testid="btn-download"</code> - Botão download TXT</li>
                <li><code>data-testid="btn-download-json"</code> - Botão download JSON</li>
                <li><code>data-testid="btn-download-csv"</code> - Botão download CSV</li>
                <li><code>data-testid="download-status"</code> - Status do download</li>
              </ul>

              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Exemplos de Teste Automatizado:</strong></p>
              
              <div class="test-tabs">
                <button class="test-tab active" data-target="tab-cypress">Cypress</button>
                <button class="test-tab" data-target="tab-playwright">Playwright</button>
                <button class="test-tab" data-target="tab-selenium-java">Selenium (Java)</button>
                <button class="test-tab" data-target="tab-capybara">Capybara (Ruby)</button>
                <button class="test-tab" data-target="tab-robot">Robot Framework</button>
              </div>
              
              <div class="test-tab-content">
              
                <pre id="tab-cypress" class="test-code active"><code>
// Cypress - Testar upload de arquivo
cy.get('[data-testid="file-input"]').selectFile('cypress/fixtures/example.jpg')
cy.get('[data-testid="file-info"]').should('contain', 'Arquivo selecionado')
cy.get('[data-testid="file-info"]').should('contain', 'Nome:')
cy.get('[data-testid="file-preview"]').should('be.visible')

// Testar download
cy.get('[data-testid="btn-download"]').click()
cy.get('[data-testid="download-status"]').should('contain', 'Download iniciado')
// Validar arquivo baixado (requer configuração)
cy.readFile('cypress/downloads/exemplo-qa-playground.txt')
                </code></pre>
              
                <pre id="tab-playwright" class="test-code"><code>
// Playwright - Testar upload de arquivo
await page.getByTestId('file-input').setInputFiles('tests/fixtures/example.jpg')
await expect(page.getByTestId('file-info')).toContainText('Arquivo selecionado')
await expect(page.getByTestId('file-info')).toContainText('Nome:')
await expect(page.getByTestId('file-preview')).toBeVisible()

// Testar download
const [download] = await Promise.all([
  page.waitForEvent('download'),
  page.getByTestId('btn-download').click()
])
const path = await download.path()
expect(path).toBeTruthy()
                </code></pre>
              
                <pre id="tab-selenium-java" class="test-code"><code>
// Selenium Java - Testar upload de arquivo
WebElement fileInput = driver.findElement(By.cssSelector("[data-testid='file-input']"));
String filePath = System.getProperty("user.dir") + "/src/test/resources/example.jpg";
fileInput.sendKeys(filePath);
WebElement fileInfo = driver.findElement(By.cssSelector("[data-testid='file-info']"));
assert fileInfo.getText().contains("Arquivo selecionado");
WebElement preview = driver.findElement(By.cssSelector("[data-testid='file-preview']"));
assert preview.isDisplayed();

// Testar download
driver.findElement(By.cssSelector("[data-testid='btn-download']")).click();
Thread.sleep(1000);
// Validar arquivo baixado
File downloadedFile = new File(System.getProperty("user.home") + "/Downloads/exemplo-qa-playground.txt");
assert downloadedFile.exists();
                </code></pre>
              
                <pre id="tab-capybara" class="test-code"><code>
# Capybara (Ruby) - Testar upload de arquivo
attach_file('file-input', Rails.root.join('spec/fixtures/example.jpg'))
expect(find('[data-testid="file-info"]')).to have_content('Arquivo selecionado')
expect(find('[data-testid="file-info"]')).to have_content('Nome:')
expect(find('[data-testid="file-preview"]')).to be_visible

# Testar download
find('[data-testid="btn-download"]').click
expect(find('[data-testid="download-status"]')).to have_content('Download iniciado')
                </code></pre>
                  
                <pre id="tab-robot" class="test-code"><code>
*** Test Cases ***
Testar upload de arquivo
    Choose File    css:[data-testid="file-input"]    ${CURDIR}/example.jpg
    Element Should Contain    css:[data-testid="file-info"]    Arquivo selecionado
    Element Should Contain    css:[data-testid="file-info"]    Nome:
    Element Should Be Visible    css:[data-testid="file-preview"]

Testar download de arquivo
    Click Element    css:[data-testid="btn-download"]
    Element Should Contain    css:[data-testid="download-status"]    Download iniciado
                </code></pre>
              
              </div>
            </div>
          </div>
        </div>

        <div style="margin-top: var(--spacing-xl); text-align: center;">
          <a href="../../index.html" class="btn btn-secondary">← Voltar para Início</a>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      QA Playground — Projeto educacional • Português
    </footer>

    <script src="../../../js/app.js"></script>
    <script>
      // Upload
      document.getElementById('file-input').addEventListener('change', function() {
        const f = this.files && this.files[0];
        const info = document.getElementById('file-info');
        const preview = document.getElementById('file-preview');
        const previewContent = document.getElementById('preview-content');
        
        if (!f) {
          info.textContent = 'Nenhum arquivo selecionado';
          info.style.color = 'var(--muted)';
          preview.style.display = 'none';
          return;
        }
        
        const sizeKB = Math.round(f.size / 1024);
        const sizeMB = (f.size / (1024 * 1024)).toFixed(2);
        const sizeText = sizeKB < 1024 ? `${sizeKB} KB` : `${sizeMB} MB`;
        
        info.innerHTML = `
          <strong style="color: var(--accent);">✅ Arquivo selecionado:</strong><br>
          Nome: ${f.name}<br>
          Tamanho: ${sizeText}<br>
          Tipo: ${f.type || 'Não especificado'}
        `;
        info.style.color = 'var(--text)';
        
        // Preview para imagens
        if (f.type.startsWith('image/')) {
          const reader = new FileReader();
          reader.onload = (e) => {
            previewContent.innerHTML = `<img src="${e.target.result}" style="max-width: 300px; border-radius: var(--border-radius-md); margin-top: var(--spacing-sm);" alt="Preview" />`;
            preview.style.display = 'block';
          };
          reader.readAsDataURL(f);
        } else {
          preview.style.display = 'none';
        }
        
        window.showToast(`Arquivo "${f.name}" selecionado (${sizeText})`);
      });

      // Download TXT
      document.getElementById('btn-download').addEventListener('click', () => {
        const content = `Arquivo de exemplo gerado em ${new Date().toLocaleString('pt-BR')}\n\nEste é um arquivo de teste para validação de downloads.\n\nQA Playground - Projeto educacional.`;
        const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'exemplo-qa-playground.txt';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        
        document.getElementById('download-status').textContent = 'Download iniciado: exemplo-qa-playground.txt';
        document.getElementById('download-status').style.color = 'var(--accent)';
        window.showToast('Download iniciado com sucesso!');
      });

      // Download JSON
      document.getElementById('btn-download-json').addEventListener('click', () => {
        const data = {
          timestamp: new Date().toISOString(),
          projeto: 'QA Playground',
          versao: '1.0.0',
          dados: [
            { id: 1, nome: 'Exemplo 1', valor: 100 },
            { id: 2, nome: 'Exemplo 2', valor: 200 }
          ]
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'dados-exemplo.json';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        
        document.getElementById('download-status').textContent = 'Download iniciado: dados-exemplo.json';
        document.getElementById('download-status').style.color = 'var(--accent)';
        window.showToast('Download JSON iniciado com sucesso!');
      });

      // Download CSV
      document.getElementById('btn-download-csv').addEventListener('click', () => {
        const csv = `Nome,Email,Idade\nJoão Silva,joao@email.com,30\nMaria Santos,maria@email.com,25\nPedro Costa,pedro@email.com,35`;
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'dados-exemplo.csv';
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        
        document.getElementById('download-status').textContent = 'Download iniciado: dados-exemplo.csv';
        document.getElementById('download-status').style.color = 'var(--accent)';
        window.showToast('Download CSV iniciado com sucesso!');
      });

      // Inicializar abas de teste automatizado
      (function() {
        function initTabs() {
          const tabsContainer = document.querySelector('.test-tabs');
          
          if (!tabsContainer) {
            setTimeout(initTabs, 100);
            return;
          }

          tabsContainer.addEventListener('click', function(e) {
            const clickedTab = e.target.closest('.test-tab');
            
            if (!clickedTab) return;
            
            e.preventDefault();
            e.stopPropagation();
            
            const targetId = clickedTab.dataset.target;
            if (!targetId) return;
            
            document.querySelectorAll('.test-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.test-code').forEach(c => c.classList.remove('active'));

            clickedTab.classList.add('active');
            const targetContent = document.getElementById(targetId);
            if (targetContent) {
              targetContent.classList.add('active');
            }
          });
        }

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', initTabs);
        } else {
          initTabs();
        }
      })();
    </script>
  </body>
</html>
