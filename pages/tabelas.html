<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Tabelas ‚Äî QA Playground</title>
    <link rel="stylesheet" href="../css/styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <header class="et-header">
      <div class="et-header-inner">
        <a href="../index.html" class="et-logo" aria-label="In√≠cio">
          <img src="../assets/icons/logo.svg" alt="Logo QA Playground" height="40" />
        </a>
        <nav class="et-nav" aria-label="Navega√ß√£o principal">
          <ul class="et-nav-list">
            <li><a href="../index.html">In√≠cio</a></li>
            <li><a href="fundamentos.html">Fundamentos</a></li>
            <li><a href="tabelas.html" aria-current="page">Tabelas</a></li>
          </ul>
        </nav>
        <div class="et-header-actions">
          <button id="theme-toggle" aria-label="Alternar tema">üåû</button>
        </div>
      </div>
    </header>

    <main class="container">
      <section class="section">
        <div class="section-header">
          <h2>Tabela Din√¢mica</h2>
          <div class="section-desc">Pratique testes em tabelas com conte√∫do din√¢mico, opera√ß√µes CRUD (Create, Read, Update, Delete) e valida√ß√£o de dados. Esta p√°gina √© ideal para testar automa√ß√£o de intera√ß√µes com listas e tabelas, incluindo adicionar, visualizar e remover itens.</div>
        </div>

        <div class="subsections subsections-vertical">
          <div class="subsection">
            <h3>Sobre esta Se√ß√£o</h3>
            <div style="background: var(--surface); padding: var(--spacing-md); border-radius: var(--border-radius-md); border-left: 4px solid var(--accent);">
              <p style="margin-bottom: var(--spacing-sm);"><strong>Atividades do Dia a Dia:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Testar opera√ß√µes CRUD (Criar, Ler, Atualizar, Deletar) em tabelas din√¢micas</li>
                <li>Validar adi√ß√£o de novos itens em listas e tabelas</li>
                <li>Testar remo√ß√£o de itens e valida√ß√£o de estado vazio</li>
                <li>Validar contagem de linhas e estrutura da tabela</li>
                <li>Praticar automa√ß√£o de intera√ß√µes com elementos din√¢micos (que aparecem/desaparecem)</li>
                <li>Testar valida√ß√£o de dados em tabelas (IDs, datas, textos)</li>
                <li>Validar comportamento com caracteres especiais e textos longos</li>
              </ul>
              
              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Como Utilizar:</strong></p>
              <ol style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Digite um nome no campo de entrada</li>
                <li>Clique em "Adicionar" ou pressione Enter para adicionar um item √† tabela</li>
                <li>Valide que o item foi adicionado com ID, nome e data de cria√ß√£o</li>
                <li>Teste adicionar m√∫ltiplos itens e verifique a contagem</li>
                <li>Clique em "Excluir" em qualquer linha para remover o item</li>
                <li>Valide que a mensagem de tabela vazia aparece quando n√£o h√° itens</li>
                <li>Use os <code>data-testid</code> para criar testes automatizados</li>
              </ol>
            </div>
          </div>

          <div class="subsection">
            <h3>CRUD Simples</h3>
            <p class="muted" style="margin-bottom: var(--spacing-md);">Adicione, visualize e remova itens da tabela.</p>
            
            <div class="controls" style="margin-bottom: var(--spacing-md);">
              <input 
                id="row-name" 
                type="text" 
                placeholder="Digite um nome"
                data-testid="input-nome-tabela"
                style="flex: 1; min-width: 200px;"
              />
              <button 
                id="btn-add" 
                class="btn"
                data-testid="btn-adicionar"
              >
                Adicionar
              </button>
            </div>

            <div style="overflow-x: auto;">
              <table class="table" id="data-table" data-testid="tabela-dados">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Data de Cria√ß√£o</th>
                    <th>A√ß√µes</th>
                  </tr>
                </thead>
                <tbody data-testid="tbody-dados">
                  <!-- Itens ser√£o inseridos aqui dinamicamente -->
                </tbody>
              </table>
            </div>

            <div id="empty-message" class="muted" style="text-align: center; padding: var(--spacing-xl); display: none;">
              Nenhum item na tabela. Adicione um item para come√ßar.
            </div>
          </div>

          <div class="subsection" style="margin-top: var(--spacing-lg);">
            <h3>Informa√ß√µes para Testes</h3>
            <div style="background: var(--surface); padding: var(--spacing-md); border-radius: var(--border-radius-md); border-left: 4px solid var(--accent);">
              <p style="margin-bottom: var(--spacing-sm);"><strong>Cen√°rios de Teste:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li>Adicionar novos itens √† tabela</li>
                <li>Validar que o item foi adicionado corretamente (ID, nome, data)</li>
                <li>Verificar contagem de linhas na tabela</li>
                <li>Remover itens da tabela e validar remo√ß√£o</li>
                <li>Validar mensagem quando a tabela est√° vazia</li>
                <li>Testar com caracteres especiais nos nomes</li>
                <li>Testar adi√ß√£o r√°pida de m√∫ltiplos itens</li>
              </ul>
              
              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Elementos identific√°veis:</strong></p>
              <ul style="margin-left: var(--spacing-lg); color: var(--muted); font-size: var(--font-size-sm);">
                <li><code>data-testid="input-nome-tabela"</code> - Campo de entrada</li>
                <li><code>data-testid="btn-adicionar"</code> - Bot√£o para adicionar item</li>
                <li><code>data-testid="tabela-dados"</code> - Tabela principal</li>
                <li><code>data-testid="tbody-dados"</code> - Corpo da tabela</li>
                <li><code>data-testid="linha-[id]"</code> - Cada linha da tabela</li>
                <li><code>data-testid="btn-excluir-[id]"</code> - Bot√£o de excluir por linha</li>
              </ul>

              <p style="margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm);"><strong>Exemplo de Teste Automatizado:</strong></p>
              <pre style="background: rgba(0,0,0,0.05); padding: var(--spacing-sm); border-radius: var(--border-radius-sm); font-size: var(--font-size-sm); overflow-x: auto;"><code>// Cypress
cy.get('[data-testid="input-nome-tabela"]').type('Item Teste')
cy.get('[data-testid="btn-adicionar"]').click()
cy.get('[data-testid="tabela-dados"]').should('be.visible')
cy.get('[data-testid="tbody-dados"] tr').should('have.length', 1)
cy.get('[data-testid="btn-excluir-1"]').click()
cy.get('[data-testid="tbody-dados"] tr').should('have.length', 0)</code></pre>
            </div>
          </div>
        </div>

        <div style="margin-top: var(--spacing-xl); text-align: center;">
          <a href="../index.html" class="btn btn-secondary">‚Üê Voltar para In√≠cio</a>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      QA Playground ‚Äî Projeto educacional ‚Ä¢ Portugu√™s
    </footer>

    <script src="../js/app.js"></script>
    <script>
      let rowIdCounter = 1;
      const rows = [];
      const tbody = document.querySelector('#data-table tbody');
      const emptyMessage = document.getElementById('empty-message');

      function renderTable() {
        tbody.innerHTML = '';
        
        if (rows.length === 0) {
          emptyMessage.style.display = 'block';
          document.getElementById('data-table').style.display = 'none';
          return;
        }

        emptyMessage.style.display = 'none';
        document.getElementById('data-table').style.display = 'table';
        
        rows.forEach((row, index) => {
          const tr = document.createElement('tr');
          tr.setAttribute('data-testid', `linha-${row.id}`);
          
          const formattedDate = new Date(row.createdAt).toLocaleString('pt-BR', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
          });
          
          tr.innerHTML = `
            <td>${row.id}</td>
            <td>${escapeHtml(row.name)}</td>
            <td>${formattedDate}</td>
            <td>
              <button 
                class="btn" 
                data-i="${index}" 
                data-testid="btn-excluir-${row.id}"
                style="padding: 6px 12px; font-size: 0.875rem;"
              >
                Excluir
              </button>
            </td>
          `;
          
          tbody.appendChild(tr);
        });

        // Adiciona event listeners aos bot√µes de excluir
        tbody.querySelectorAll('button').forEach(btn => {
          btn.addEventListener('click', handleDelete);
        });
      }

      function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      function handleDelete(e) {
        const index = Number(e.target.dataset.i);
        const removedRow = rows[index];
        
        rows.splice(index, 1);
        renderTable();
        
        window.showToast(`Item "${removedRow.name}" removido com sucesso!`);
      }

      document.getElementById('btn-add').addEventListener('click', function() {
        const input = document.getElementById('row-name');
        const name = input.value.trim();
        
        if (!name) {
          window.showToast('Por favor, digite um nome.');
          input.focus();
          return;
        }
        
        const newRow = {
          id: rowIdCounter++,
          name: name,
          createdAt: new Date()
        };
        
        rows.push(newRow);
        input.value = '';
        input.focus();
        renderTable();
        
        window.showToast(`Item "${name}" adicionado com sucesso!`);
      });

      // Permitir adicionar com Enter
      document.getElementById('row-name').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          document.getElementById('btn-add').click();
        }
      });

      // Inicializa a tabela
      renderTable();
    </script>
  </body>
</html>
